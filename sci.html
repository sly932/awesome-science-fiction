<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ç§‘å¹»å¤§å¥–å¹´è¡¨ Appï¼ˆSingle HTMLï¼‰</title>
<style>
  :root{
    --bg:#0b0f14; --card:#111826; --muted:#8aa0b3; --text:#e8eef5; --accent:#6dd3ff; --accent2:#a0ffb7;
    --border:#1f2a3a; --head:#0e1724; --btn:#0f2233; --btn-hover:#35567a;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);
    font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Hiragino Sans GB","Noto Sans SC","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;}
  a{color:var(--accent)}
  header{position:sticky;top:0;background:linear-gradient(180deg,rgba(11,15,20,.95),rgba(11,15,20,.78));backdrop-filter:blur(6px);z-index:10}
  .wrap{max-width:1200px;margin:0 auto;padding:20px 24px}
  h1{margin:6px 0 0;font-size:28px;letter-spacing:.2px}
  .sub{color:var(--muted);margin:6px 0 12px}
  .toolbar{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
  .pill{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);padding:6px 10px;border-radius:999px;color:var(--muted);font-size:12px}

  section{margin:26px 0}
  .block{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:20px;margin:18px 0}
  .block h2{margin:0 0 6px;font-size:22px}
  .block .note{color:#b8c8d8;font-size:13px;margin:6px 0 0;line-height:1.6}

  .award{margin:18px 0 26px;border:1px solid var(--border);border-radius:14px;overflow:hidden}
  .award-header{display:flex;flex-wrap:wrap;align-items:center;gap:10px;justify-content:space-between;padding:12px 14px;background:var(--head)}
  .award-title{font-weight:700;font-size:18px;display:flex;align-items:center;gap:10px}
  .controls{display:flex;gap:8px;align-items:center}
  button{background:var(--btn);color:var(--text);border:1px solid var(--border);padding:6px 10px;border-radius:8px;cursor:pointer}
  button:hover{border-color:var(--btn-hover)}
  .toggle{background:#0b1a27}
  .search{display:flex;gap:8px;align-items:center}
  .search input{background:var(--btn);border:1px solid var(--border);color:var(--text);padding:8px 10px;border-radius:8px;flex:1;min-width:220px}

  .award-body{display:block}
  .award.collapsed .award-body{display:none}
  .award.collapsed .toggle .label{opacity:.85}

  table{width:100%;border-collapse:collapse;font-size:14px}
  thead th{position:sticky;top:calc(60px + 12px);background:var(--head);z-index:1}
  th,td{padding:8px 10px;border-bottom:1px solid var(--border);vertical-align:top}
  td.small, th.small{white-space:nowrap}
  .legend{color:var(--muted);font-size:12px;margin:6px 14px 14px}

  .footer{color:var(--muted);font-size:12px;margin:30px 0 10px}
  .row-mono{font-family:ui-monospace,SFMono-Regular,Consolas,Monaco,monospace;font-size:12px;color:#a9b7c6}
  @media (max-width:640px){
    .search input{min-width:140px}
    thead th{top:0}
  }
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>ç§‘å¹»å¤§å¥–å¹´è¡¨ Â· å•é¡µåº”ç”¨</h1>
    <div class="sub">ä¸‰å¤§æ¿å—ï¼š<b>å½±è§†</b>ã€<b>å›½é™…ç§‘å¹»æ–‡å­¦</b>ã€<b>ä¸­æ–‡ç§‘å¹»</b>ã€‚æ¯ä¸ªå¥–é¡¹è¡¨æ ¼æ”¯æŒ<b>ç‹¬ç«‹</b>çš„æ—¶é—´å€’åº/æ­£åºåˆ‡æ¢ä¸å…³é”®è¯æœç´¢ï¼Œå¹¶å¯<b>æ”¶èµ·/å±•å¼€</b>ã€‚æ•°æ®è¯·é€šè¿‡å³ä¸Šè§’â€œå¯¼å…¥æ•°æ®ï¼ˆJSONï¼‰â€åŠ è½½ã€‚</div>
    <div class="toolbar">
      <div class="pill">ğŸ—“ è¿‘100å¹´ï¼ˆæŒ‰å„å¥–é¡¹å†å²æ‰€åŠï¼‰</div>
      <div class="pill">ğŸ”€ æ¯å¥–é¡¹ç‹¬ç«‹æ’åº</div>
      <div class="pill">ğŸ§­ æ”¯æŒæ”¶èµ·/å±•å¼€</div>
      <div class="pill">ğŸŒ è‹±æ–‡ä½œå“å«ä¸­æ–‡è¯‘å</div>
      <button id="expandAll">å…¨éƒ¨å±•å¼€</button>
      <button id="collapseAll">å…¨éƒ¨æ”¶èµ·</button>
      <button id="importBtn">å¯¼å…¥æ•°æ®ï¼ˆJSONï¼‰</button>
      <button id="exportBtn">å¯¼å‡ºæ•°æ®ï¼ˆJSONï¼‰</button>
      <input id="importFile" type="file" accept="application/json" style="display:none" />
    </div>
  </div>
</header>

<main class="wrap">
  <!-- ========== å½±è§† ========== -->
  <section id="film" class="block">
    <h2>ğŸ“½ï¸ å½±è§†</h2>
    <div class="note">ç¤ºä¾‹å«ï¼šé›¨æœå¥–æœ€ä½³æˆå‰§è¡¨ç°ï¼ˆé•¿ç¯‡ï¼‰ã€åœŸæ˜Ÿå¥–æœ€ä½³ç§‘å¹»ç”µå½±ã€å¥¥æ–¯å¡æœ€ä½³è§†è§‰æ•ˆæœï¼ˆç§‘å¹»ç›¸å…³ï¼‰ã€‚</div>

    <!-- é›¨æœÂ·æˆå‰§ï¼ˆé•¿ç¯‡ï¼‰ -->
    <div class="award" data-award="hugo_drama_long">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          é›¨æœå¥– Â· æœ€ä½³æˆå‰§è¡¨ç°ï¼ˆé•¿ç¯‡ï¼‰
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="åœ¨è¯¥å¥–é¡¹å†…æœç´¢ç‰‡å/å¯¼æ¼”â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>å¯¼æ¼” / ä¸»åˆ›</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="legend">* 2003 å¹´èµ·åˆ†é•¿/çŸ­ç¯‡ï¼›æ­¤å¤„ä¸ºé•¿ç¯‡å­ç±»ã€‚å¯¼å…¥åè‡ªåŠ¨æ¸²æŸ“ã€‚</div>
      </div>
    </div>

    <!-- åœŸæ˜Ÿå¥–Â·ç§‘å¹»ç”µå½± -->
    <div class="award" data-award="saturn_sf">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          åœŸæ˜Ÿå¥– Â· æœ€ä½³ç§‘å¹»ç”µå½±
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="åœ¨è¯¥å¥–é¡¹å†…æœç´¢ç‰‡å/å¯¼æ¼”â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>å¯¼æ¼”</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- å¥¥æ–¯å¡Â·è§†è§‰æ•ˆæœï¼ˆç¤ºä¾‹ï¼‰ -->
    <div class="award" data-award="oscar_vfx">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          å¥¥æ–¯å¡ Â· æœ€ä½³è§†è§‰æ•ˆæœï¼ˆç§‘å¹»ç›¸å…³ï¼‰
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="åœ¨è¯¥å¥–é¡¹å†…æœç´¢ç‰‡å/ä¸»åˆ›â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>å¯¼æ¼” / è§†æ•ˆä¸»ç®¡</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- ========== å›½é™…ç§‘å¹»æ–‡å­¦ ========== -->
  <section id="intl" class="block">
    <h2>ğŸŒ å›½é™…ç§‘å¹»æ–‡å­¦å¥–</h2>
    <div class="note">ç¤ºä¾‹å«ï¼šé›¨æœå¥–ã€æ˜Ÿäº‘å¥–ï¼ˆNebulaï¼‰ã€è½¨è¿¹å¥–ï¼ˆLocusï¼‰ã€é˜¿ç‘ŸÂ·CÂ·å…‹æ‹‰å…‹å¥–ã€‚</div>

    <div class="award" data-award="hugo_best_novel">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          é›¨æœå¥– Â· æœ€ä½³é•¿ç¯‡å°è¯´
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="æœç´¢ä¹¦å/ä½œè€…â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>ä½œè€…</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="award" data-award="nebula_best_novel">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          æ˜Ÿäº‘å¥–ï¼ˆNebulaï¼‰ Â· æœ€ä½³é•¿ç¯‡å°è¯´
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="æœç´¢ä¹¦å/ä½œè€…â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>ä½œè€…</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="award" data-award="locus_sf_novel">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          è½¨è¿¹å¥–ï¼ˆLocusï¼‰ Â· æœ€ä½³ç§‘å¹»é•¿ç¯‡
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="æœç´¢ä¹¦å/ä½œè€…â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>ä½œè€…</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="award" data-award="clarke_award">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          é˜¿ç‘ŸÂ·CÂ·å…‹æ‹‰å…‹å¥– Â· å¹´åº¦è‹±å›½å‡ºç‰ˆç§‘å¹»é•¿ç¯‡
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="æœç´¢ä¹¦å/ä½œè€…â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>ä½œè€…</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- ========== ä¸­æ–‡ç§‘å¹» ========== -->
  <section id="cn" class="block">
    <h2>ğŸ€„ ä¸­æ–‡ç§‘å¹»å¥–</h2>
    <div class="note">ç¤ºä¾‹å«ï¼šä¸­å›½é“¶æ²³å¥–ã€ä¸­å›½æ˜Ÿäº‘å¥–ï¼ˆåè¯­ç§‘å¹»ï¼‰ã€æ—¥æœ¬æ˜Ÿäº‘èµï¼ˆé™„ä¸­æ–‡è¯‘åï¼‰ã€‚</div>

    <div class="award" data-award="china_galaxy_long">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          ä¸­å›½é“¶æ²³å¥– Â· é•¿ç¯‡å°è¯´
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="æœç´¢ä¹¦å/ä½œè€…â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>ä½œè€…</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="award" data-award="china_nebula_long">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          ä¸­å›½æ˜Ÿäº‘å¥– Â· é•¿ç¯‡å°è¯´
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="æœç´¢ä¹¦å/ä½œè€…â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / è‹±ï¼‰</th><th>ä½œè€…</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="award" data-award="jp_seiun_long">
      <div class="award-header">
        <div class="award-title">
          <button class="toggle"><span class="label">æ”¶èµ·</span></button>
          æ—¥æœ¬æ˜Ÿäº‘èµ Â· æ—¥æœ¬é•¿ç¯‡éƒ¨é—¨
        </div>
        <div class="controls">
          <button data-action="toggleSort">æ—¶é—´æ’åºï¼š<span class="sort-label">å€’åº</span></button>
          <div class="search"><input placeholder="æœç´¢ä¹¦å/ä½œè€…â€¦" data-action="filter" /></div>
        </div>
      </div>
      <div class="award-body">
        <table>
          <thead><tr><th class="small">å¹´ä»½</th><th>ä½œå“ï¼ˆä¸­ / æ—¥ / è‹±ï¼‰</th><th>ä½œè€…</th><th class="small">åŸå§‹è¯­è¨€</th><th>å¤‡æ³¨</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <div class="footer wrap">
    <div>æ³¨ï¼šæœ¬é¡µä¸å†å†…ç½®ç¤ºä¾‹æ•°æ®ï¼Œè¯·ä½¿ç”¨â€œå¯¼å…¥æ•°æ®ï¼ˆJSONï¼‰â€åŠ è½½æˆ–â€œå¯¼å‡ºæ•°æ®ï¼ˆJSONï¼‰â€ä¿å­˜å½“å‰ <code>window.DATA</code>ã€‚</div>
    <div class="row-mono">è¡Œæ•°æ®å­—æ®µï¼š{ year:Number, title_zh:String, title_en:String, people:String, lang:String, note:String }</div>
  </div>
</main>

<script>
(() => {
  'use strict';

  // æ•°æ®åˆå§‹åŒ–ï¼ˆç©ºï¼‰
  window.DATA = window.DATA || {};

  // æ¸²æŸ“å‡½æ•°
  function renderAward(el, key, ascending=false, filterText=""){
    const tbody = el.querySelector("tbody");
    const rows = (window.DATA[key]||[]).slice();
    rows.sort((a,b)=> ascending ? (a.year - b.year) : (b.year - a.year));
    const q = (filterText||"").trim().toLowerCase();
    const fmt = v => v==null? "": v;
    const safe = s => String(s).replace(/[&<>]/g, m=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[m]));
    let out = "";
    for(const r of rows){
      const hay = `${r.year} ${r.title_zh||''} ${r.title_en||''} ${r.people||''} ${r.lang||''} ${r.note||''}`.toLowerCase();
      if(q && !hay.includes(q)) continue;
      out += `<tr>
        <td class="small">${safe(r.year)}</td>
        <td><b>${safe(fmt(r.title_zh))}</b><br><i>${safe(fmt(r.title_en))}</i></td>
        <td>${safe(fmt(r.people))}</td>
        <td class="small">${safe(fmt(r.lang))}</td>
        <td>${safe(fmt(r.note))}</td>
      </tr>`;
    }
    tbody.innerHTML = out || `<tr><td colspan="5" style="color:#9cb0c4">æš‚æ— åŒ¹é…è®°å½•ï¼ˆå¯é€šè¿‡å³ä¸Šè§’å¯¼å…¥ JSON æ•°æ®ï¼‰</td></tr>`;
  }

  // è®¡ç®— sticky è¡¨å¤´é¿å…é®æŒ¡
  function setStickyGap(awardEl){
    const thead = awardEl.querySelector('thead');
    if(thead){
      const h = Math.ceil(thead.getBoundingClientRect().height);
      awardEl.style.setProperty('--thead-gap', h + 'px');
    }
  }

  // åˆå§‹åŒ–æ¯ä¸ª award çš„äº¤äº’
  function setupAward(awardEl){
    const key = awardEl.getAttribute("data-award");
    let ascending = false;
    let filterText = "";
    const sortBtn = awardEl.querySelector('button[data-action="toggleSort"]');
    const sortLabel = awardEl.querySelector('.sort-label');
    const filterInput = awardEl.querySelector('input[data-action="filter"]');
    const toggleBtn = awardEl.querySelector('.toggle');
    const toggleLabel = awardEl.querySelector('.toggle .label');
    const update = ()=> { renderAward(awardEl, key, ascending, filterText); setStickyGap(awardEl); };

    if(sortBtn){
      sortBtn.addEventListener('click', ()=>{
        ascending = !ascending;
        if(sortLabel) sortLabel.textContent = ascending ? "æ­£åº" : "å€’åº";
        update();
      });
    }
    if(filterInput){
      filterInput.addEventListener('input', (e)=>{
        filterText = e.target.value || "";
        update();
      });
    }
    if(toggleBtn){
      toggleBtn.addEventListener('click', ()=>{
        awardEl.classList.toggle('collapsed');
        if(toggleLabel) toggleLabel.textContent = awardEl.classList.contains('collapsed') ? "å±•å¼€" : "æ”¶èµ·";
      });
    }
    update();
  }

  // å…¬å¼€çš„é‡æ–°æ¸²æŸ“å‡½æ•°ï¼ˆé¿å…å‘½åå†²çªï¼‰
  function reRenderAllFromUIFunc(){
    document.querySelectorAll('.award').forEach(el=>{
      const key = el.getAttribute('data-award');
      const sortLabel = el.querySelector('.sort-label');
      const ascending = sortLabel && sortLabel.textContent.trim() === 'æ­£åº';
      const filterInput = el.querySelector('input[data-action="filter"]');
      const filterText = filterInput ? filterInput.value : '';
      renderAward(el, key, ascending, filterText);
      setStickyGap(el);
    });
  }
  window.reRenderAllFromUIFunc = reRenderAllFromUIFunc;

  // åˆå§‹åŒ–
  document.querySelectorAll('.award').forEach(setupAward);

  document.getElementById('expandAll').addEventListener('click', ()=>{
    document.querySelectorAll('.award').forEach(el=>{
      el.classList.remove('collapsed');
      const lbl = el.querySelector('.toggle .label'); if(lbl) lbl.textContent = "æ”¶èµ·";
    });
  });
  document.getElementById('collapseAll').addEventListener('click', ()=>{
    document.querySelectorAll('.award').forEach(el=>{
      el.classList.add('collapsed');
      const lbl = el.querySelector('.toggle .label'); if(lbl) lbl.textContent = "å±•å¼€";
    });
  });

  // å¯¼å…¥ JSON
  const importBtn = document.getElementById('importBtn');
  const importFile = document.getElementById('importFile');
  if(importBtn && importFile){
    importBtn.addEventListener('click', ()=> importFile.click());
    importFile.addEventListener('change', async (e)=>{
      try{
        const file = e.target.files && e.target.files[0];
        if(!file){ return; }
        const text = await file.text();
        const parsed = JSON.parse(text);
        const candidate = (parsed && (parsed.DATA || (parsed.window && parsed.window.DATA))) || parsed;
        if(!candidate || typeof candidate !== 'object') throw new Error('JSON æ ¹å¯¹è±¡åº”ä¸ºå¯¹è±¡');
        const keys = Object.keys(candidate);
        if(keys.length === 0) throw new Error('æœªæ£€æµ‹åˆ°ä»»ä½•å¥–é¡¹é”®');
        for(const k of keys){
          if(!Array.isArray(candidate[k])) throw new Error(`é”® ${k} çš„å€¼åº”ä¸ºæ•°ç»„`);
        }
        window.DATA = candidate;
        reRenderAllFromUIFunc();
        alert(`å¯¼å…¥æˆåŠŸï¼š${keys.length} ä¸ªå¥–é¡¹ã€‚`);
      }catch(err){
        console.error(err);
        alert('å¯¼å…¥å¤±è´¥ï¼š' + (err && err.message ? err.message : 'æœªçŸ¥é”™è¯¯'));
      }finally{
        importFile.value = '';
      }
    });
  }

  // å¯¼å‡º JSON
  const exportBtn = document.getElementById('exportBtn');
  if(exportBtn){
    exportBtn.addEventListener('click', ()=>{
      try{
        const data = window.DATA || {};
        const json = JSON.stringify(data, null, 2);
        const blob = new Blob([json], {type: 'application/json'});
        const url = URL.createObjectURL(blob);
        const ts = new Date();
        const pad = n => String(n).padStart(2, '0');
        const filename = `scifi_awards_${ts.getFullYear()}${pad(ts.getMonth()+1)}${pad(ts.getDate())}_${pad(ts.getHours())}${pad(ts.getMinutes())}${pad(ts.getSeconds())}.json`;
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        setTimeout(()=>{
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        }, 0);
      }catch(err){
        console.error(err);
        alert('å¯¼å‡ºå¤±è´¥ï¼š' + (err && err.message ? err.message : 'æœªçŸ¥é”™è¯¯'));
      }
    });
  }

  // çª—å£å˜åŒ–æ—¶æ›´æ–° gap
  window.addEventListener('resize', ()=>{
    document.querySelectorAll('.award').forEach(setStickyGap);
  });

  // ===== è½»é‡è‡ªæ£€ï¼ˆä¸ä¼šé˜»æ–­è¿è¡Œï¼‰ =====
  (function selfTests(){
    const t = (name, fn)=>{ try{ fn(); console.log('TEST PASS:', name); }catch(e){ console.error('TEST FAIL:', name, e); } };
    t('reRenderAllFromUIFunc exists', ()=>{ if(typeof window.reRenderAllFromUIFunc !== 'function') throw new Error('missing'); });
    t('Import/Export buttons exist', ()=>{ if(!document.getElementById('importBtn') || !document.getElementById('exportBtn')) throw new Error('buttons missing'); });
    t('Render with empty DATA does not throw', ()=>{ document.querySelectorAll('.award').forEach(el => renderAward(el, el.getAttribute('data-award'))); });
  })();
})();
</script>
</body>
</html>
